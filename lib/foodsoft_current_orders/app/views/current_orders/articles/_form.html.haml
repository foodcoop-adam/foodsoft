.row-fluid

  .span4
    .well
      %ul.nav.nav-list#article_list
        %li.keep
          = form_for @q, url: current_orders_articles_path, method: 'get', html: {data: {'submit-onchange' => true}, class: 'form-search'}, remote: true do |f|
            .input-append
              = f.text_field :article_name_contains, placeholder: t('.article_placeholder'), class: 'search-query input-block-level resettable'
              %button.add-on.btn.reset-search{type: 'button'}
                %i.icon.icon-remove
        = render 'articles', orders: @current_orders

  .span8
    = render 'article', order_article: @order_article
    = render 'shared/articles_by/common'


- content_for :javascript do
  :javascript

    $(function() {

      // update number of received items - would prefer to do this server-side to
      // keep working when showing a partial list, but this avoids an extra ajax call
      $(document).on('GroupOrderArticle#update', function(e) {
        var count_sum = 0;
        $('#articles_by_articles input[data-delta]').each(function() {
          count_sum += Number($(this).val());
        });
        $('#single_order_article_total .count_sum').html(count_sum);
      });

      // add ordergroup
      $('#group_order_article_ordergroup_id').select2().select2('data', null);
      $(document).on('GroupOrderArticle#create', function(e) {
        // reset selection
        $('#group_order_article_ordergroup_id').select2('data', null);
        // update table
        $.ajax({
          url: '#{show_on_group_order_article_create_current_orders_articles_path}',
          type: 'get',
          data: {group_order_article_id: e.group_order_article_id}
        });
      });
    });

