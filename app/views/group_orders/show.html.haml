- content_for :javascript do
  :javascript
    $(function() {
      $('tr.ignored').hide();
    });

- title t('.title', order: @order.name), false
%h2
  = @order.name
  %span{style: 'font-weight: normal; font-size: 50%; vertical-align: middle;'}= t 'group_orders.switch_order.remaining', remaining: time_ago_in_words(@order.ends)


// Article box
.column_content#result
  - if @group_order
    %table.table.table-hover
      %thead
        %tr
          %th{style: "width:40%"}= t '.articles.name'
          %th= t '.articles.units'
          %th= t '.articles.unit_price'
          %th
            %abbr{title: t('.articles.ordered_title')}= t '.articles.ordered'
          %th
            %abbr{title: t('.articles.order_nopen_title')}
              - if @order.open?
                = t '.articles.order_open'
              - else
                = t '.articles.order_not_open'
          %th= t '.articles.total_price'
      %tbody
        - for category_name, order_articles in @order.articles_grouped_by_category
          %tr.article-category
            %td
              = category_name
              %i.icon-tag
            %td{colspan: "9"}
          - order_articles.each do |oa|
            - # get the order-results for the ordergroup
            - r = get_order_results(oa, @group_order.id)
            %tr{class: cycle('even', 'odd', name: 'articles') + " " + order_article_class_name(r[:quantity], r[:tolerance], r[:result])}
              %td{style: "width:40%"}
                = oa.article.name
                - unless oa.article.note.blank?
                  = image_tag("lamp_grey.png", {alt: "Notiz anzeigen", size: "15x16", border: "0", onmouseover: "$('note_#{oa.id}').show();", onmouseout: "$('note_#{oa.id}').hide();"})
              %td= "#{oa.price.unit_quantity} x #{oa.article.unit}"
              %td= number_to_currency(oa.price.fc_price)
              %td
                = r[:quantity]
                = "+ #{r[:tolerance]}" if oa.price.unit_quantity > 1
              %td= r[:result] > 0 ? r[:result] : "0"
              %td= number_to_currency(r[:sub_total])
            - unless oa.article.note.blank?
              %tr{id: "note_#{oa.id}", class: "note even", style: "display:none"}
                %td{colspan: "6"}=h oa.article.note
        %tr{class: cycle('even', 'odd', name: 'articles')}
          %th{colspan: "5"}= t '.articles.sum'
          %th= number_to_currency(@group_order.price)
    %p{style: 'text-align: right'}
      = link_to(t('.articles.edit_order'), edit_group_order_path(@group_order, order_id: @order.id), class: 'btn') if @order.open?
      = link_to 'Continue', root_path(anchor: ''), class: 'btn btn-primary'
    -# XXX TODO I18n Continue
  - else
    - if @order.open?
      = t '.articles.not_ordered_msg'
      = link_to t('.articles.order_now'), action: "order", id: @order
    - else
      = t '.articles.order_closed_msg'

